(()=>{"use strict";const e=(e,t)=>{let n=[...e],a="";if(t){for(let e=0;e<n.length;e++)a+=`\n\t\t\t<a href="../html/focus.html?id=${n[e].id}">\n    \t<article>\n\t\t<img class="logements_img" src="../images/${n[e].imageUrl}.jpg" alt="" />\n\t\t<p class="titre">${n[e].name}</p>\n\t\t<p class="type">${n[e].type}</p>\n\t\t<p class="prix"><span class="gras">${n[e].prix} €</span>&nbsp;par nuit</p>\n\t\t</article>\n\t\t</a>\n        `;document.querySelector(".photo_zone").innerHTML=a}else{for(let e=0;e<n.length;e++)a+=`\n     \n    \t<article>\n\t\t<img class="logements_img blur" src="../images/${n[e].imageUrl}.jpg" alt="" />\n\t\t<p class="titre">${n[e].name}</p>\n\t\t<p class="type">${n[e].type}</p>\n\t\t<p class="prix"><span class="gras">${n[e].prix} €</span>&nbsp;par nuit</p>\n\t\t</article>\n\t\n        `;document.querySelector(".photo_zone").innerHTML=a}},t=class{constructor(e,t,n){this.year=e,this.month=t,this.date=n,this.donnée=[{year:this.year,month:[{janvier:31,fevrier:28,mars:31,avril:30,mai:31,juin:30,juillet:31,aout:31,septembre:30,octobre:31,novembre:30,decembre:31}],day:["lundi","mardi","mercredi","jeudi","vendredi","samedi","dimanche"]}]}isThisYearBisextil(){return this.year%4==0&&this.year%100!=0||this.year%400==0}getDay(e,t,n){return new Date(e,t-1,n-1).getDay()}},n=(e,t,n,a,r)=>{const i=["Lun.","Mar.","Mer.","Jeu.","Ven.","Sam.","Dim."],o=r.donnée[0].month[0][t],s=a;let l=0,d=1,c=document.createElement("div");c.className="container";let m=document.createElement("div");m.className="divPara";let u=document.createElement("p"),p=document.createElement("p");u.className="paraMonth",p.className="paraYear";let g=document.createTextNode(`${t}`),h=document.createTextNode(` ${e}`);u.appendChild(g),p.appendChild(h),m.appendChild(u),m.appendChild(p),c.appendChild(m);let v=document.createElement("table"),y=document.createElement("thead"),f=document.createElement("tr");for(let e=0;e<i.length;e++){let t=document.createElement("th"),n=document.createTextNode(`${i[e]}`);t.appendChild(n),f.appendChild(t)}y.appendChild(f),v.appendChild(y);for(let e=0;e<6;e++){let e=document.createElement("tr");for(let t=0;t<i.length;t++){let t,n=document.createElement("td");l<s||d>o?t=document.createTextNode(""):(t=document.createTextNode(`${d}`),n.className="joursSemaine",d++),l++,n.appendChild(t),e.appendChild(n)}v.appendChild(e),c.appendChild(v)}return c},a=(e,t)=>{let n=e.donnée[0].month[0];return Object.keys(n)[t-1]},r=(e,t,n,a,r,i,o,s,l)=>{let d;e?(d=n,n=[o,s,l]):(d=a,a=[o,s,l]);let c=!1;c=((e,t)=>{if(e[2]==t[2]){if(e[1]<t[1])return!0;if(e[1]==t[1]){if(e[0]<t[0])return!0;console.log("erreur")}}else{if(e[2]<t[2])return!0;console.log("error")}})(n,a),!c&&e&&(n=d),c||e||(a=d),c&&(document.querySelectorAll("td").forEach((e=>{e.classList.remove(r)})),t.target.classList.add(r));let m=document.getElementsByTagName("td");return Array.from(m).some((e=>e.classList.contains(i)))&&Array.from(m).some((e=>e.classList.contains(r)))?document.querySelector(".search").style.backgroundColor="green":document.querySelector(".search").style.backgroundColor="rgb(9, 1, 109)",e?n:a},i=[{imageUrl:"1",reservation:[],voyageurs:2,id:"c52db0f2-e1b2-4e25-84f7-04085e2de230",name:"Maison en montagne",type:"particulier",prix:50,description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."},{imageUrl:"2",reservation:[],voyageurs:4,id:"bdcaac68-a668-4a03-846b-4c39c5d5e98c",name:"Maison en ville",type:"bla bla bla",prix:70,description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."},{imageUrl:"3",reservation:[],voyageurs:3,id:"7f888269-0446-4b17-a17d-f7a164cfb1bb",name:"Maison en campagne",type:"bla bla bla",prix:25,description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."},{imageUrl:"4",reservation:[],voyageurs:5,id:"9462562a-0d22-4085-950a-420666cd7686",name:"Maison bla bla bla...",type:"bla bla bla",prix:114,description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."}],o=(e,t,n)=>{let a=(i=window.location.href,new URL(i).searchParams.get("id")),r=JSON.parse(localStorage.getItem("date"));var i;e=r.start,t=r.end,((e,t,n,a)=>{let r=[...e],i=((e,t)=>{let n=new Date(e[2],e[1]-1,e[0]),a=new Date(t[2],t[1]-1,t[0])-n;return a/=864e5,a})(n,a),o=r.filter((e=>e.id===t)),s=Math.floor(o[0].prix)*Math.floor(i)+10,l=`\n  <div class="container_principal">\n  <p class="title">${o[0].name}</p>\n  <img src="../images/${o[0].imageUrl}.jpg" alt="" />\n  <p class="description_title">Description:</p>\n  <p class="description">${o[0].description}</p>\n  <p class="nbVoyageurs">${o[0].voyageurs} voyageurs max</p>\n</div>\n<div class="fiche_focus">\n  <div class="title">\n      <p>\n          <span class="prix">${o[0].prix}</span>&nbsp;<span class="money"\n              >€</span\n          >\n          par nuit\n      </p>\n  </div>\n  <div class="carré">\n      <div class="carré_when">\n          <div class="arrivee">\n              <p>Arrivée</p>\n              <p>${n[0]}/${n[1]}/${n[2]}</p>\n          </div>\n          <div class="depart">\n              <p>Départ</p>\n              <p>${a[0]}/${a[1]}/${a[2]}</p>\n          </div>\n      </div>\n      <div class="voyageurs">\n          <p>Voyageurs</p>\n          <p>1 voyageur</p>\n      </div>\n  </div>\n  <button id="btn-louer" class="btn">Louer</button>\n  <div class="calculs">\n      <div class="nuits">\n          <p>${Math.floor(o[0].prix)} x ${Math.floor(i)} nuits:</p>\n          <p>&nbsp;${Math.floor(o[0].prix)*Math.floor(i)} €</p>\n      </div>\n      <div class="frais">\n          <div class="frais_booking">\n              <p>Frais de service booking</p>\n              <p>10 €</p>\n          </div>\n      </div>\n      <div class="total">\n          <p>Total: </p>\n          <p>&nbsp; ${s} €</p>\n      </div>\n  </div>\n</div>\n  `;document.querySelector(".focus").innerHTML=l})(n,a,e,t),document.addEventListener("click",(n=>{if("btn-louer"===n.target.id){if(JSON.stringify(e)===JSON.stringify([0,0,0]))return void alert("choisir une date de départ");if(JSON.stringify(t)==JSON.stringify([32,13,3e3]))return void alert("Choisir une date d'arrivée");let n=JSON.parse(localStorage.getItem("logements"));for(let r=0;r<n.length;r++)n[r].id===a&&(n[r].reservation.push({arrivee:[{date:e[0],month:e[1],year:e[2]}],depart:[{date:t[0],month:t[1],year:t[2]}]}),e=[0,0,0],t=[32,13,3e3],window.location.href="../index.html");localStorage.setItem("logements",JSON.stringify(n))}}))};let s=!1;null==JSON.parse(localStorage.getItem("logements"))&&localStorage.setItem("logements",JSON.stringify(i));let l=!0,d=!1,c=[0,0,0],m=[32,13,3e3];switch((()=>{const e=window.location.pathname.split("/");return e[e.length-1].replace(".html","")})()){case"index":case"":null==JSON.parse(localStorage.getItem("logements"))&&localStorage.setItem("logements",JSON.stringify(i)),e(i,!1);break;case"focus":o(c,m,i);break;default:console.error("Page introuvable")}let u=(()=>{let e=new Date,t=e.getFullYear(),n=e.getMonth()+1;return[e.getDate(),n,t]})(),p=u[2],g=u[1],h=u[0],v=new t(p,g,h),y=p,f=document.createElement("div");f.id="diapo_container";let b="";for(let e=y;e<y+3;e++){let r=new t(e,g,h),i=r.isThisYearBisextil();r.donnée[0].month[0].fevrier=i?29:28;for(let e=g;e<13;e++){let t=a(r,e),i=r.getDay(r.donnée[0].year,e,1),o=n(r.donnée[0].year,t,0,i,r);b+=o;let s=document.createElement("div");s.className="mois",s.appendChild(o),f.appendChild(s)}g=1}document.querySelector(".modal_content").appendChild(f),document.addEventListener("click",(e=>{if("btn-calendar"===e.target.id){let e=document.querySelector(".modal");document.querySelector(".calendar").classList.add("bottom"),"hidden"===e.classList[1]?e.classList.remove("hidden"):e.classList.add("hidden")}}));let S=0,x=f.childElementCount;document.addEventListener("click",(e=>{e.target.classList.contains("fa-angles-left")&&(S=(e=>(e<=0||(e--,document.getElementById("diapo_container").style.transform=`translateX(${-800*e}px)`),e))(S))})),document.addEventListener("click",(e=>{e.target.classList.contains("fa-angles-right")&&(S=((e,t)=>++e==t/2?e-1:(document.getElementById("diapo_container").style.transform=`translateX(${-800*e}px)`,e))(S,x))})),document.addEventListener("click",(e=>{if(e.target.classList.contains("joursSemaine")){let t=e.target.closest("table").parentElement,n=parseInt(e.target.textContent),a=parseInt(t.querySelector(".paraYear").textContent),i=t.querySelector(".paraMonth").textContent;i=((e,t)=>{let n=Object.keys(e.donnée[0].month[0]);for(let e=0;e<n.length;e++)if(n[e]===t)return e+1})(v,i),l&&(c=r(!0,e,c,m,"choosenOneDepart","choosenOneArrivee",n,i,a)),d&&(m=r(!1,e,c,m,"choosenOneArrivee","choosenOneDepart",n,i,a))}})),document.addEventListener("click",(e=>{if(e.target.classList.contains("start")){l=!l,d=!1,document.querySelector(".end").style.backgroundColor="rgb(9, 1, 109)",document.querySelector(".start").style.backgroundColor=l?"green":"rgb(9, 1, 109);"}})),document.addEventListener("click",(e=>{if(e.target.classList.contains("end")){d=!0,l=!1,document.querySelector(".start").style.backgroundColor="rgb(9, 1, 109)",document.querySelector(".end").style.backgroundColor=d?"purple":"rgb(9, 1, 109)"}})),document.addEventListener("click",(t=>{if(t.target.classList.contains("search")){if(JSON.stringify(c)===JSON.stringify([0,0,0]))return void alert("choisir une date de départ");if(JSON.stringify(m)==JSON.stringify([32,13,3e3]))return void alert("Choisir une date d'arrivée");let t={start:c,end:m};localStorage.setItem("date",JSON.stringify(t)),s=!0;let n=((e,t,n)=>{let a=[];function r(e,t,n){for(const a of e){const e=new Date(a.arrivee[0].year,a.arrivee[0].month-1,a.arrivee[0].date),r=new Date(a.depart[0].year,a.depart[0].month-1,a.depart[0].date),i=new Date(t[2],t[1]-1,t[0]),o=new Date(n[2],n[1]-1,n[0]);if(!(r<=i||e>=o))return!0}return!1}for(let i=0;i<e.length;i++)r(e[i].reservation,t,n)||a.push(e[i]);return a})(JSON.parse(localStorage.getItem("logements")),c,m);e(n,s),document.querySelector(".modal").classList.add("hidden")}})),document.addEventListener("click",(e=>{e.target.classList.contains("close-calendar")&&document.querySelector(".modal").classList.add("hidden")}))})();